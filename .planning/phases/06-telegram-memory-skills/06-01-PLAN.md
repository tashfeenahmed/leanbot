---
phase: 06-telegram-memory-skills
plan: 01
type: execute
---

<objective>
Create memory_search skill wrapping existing HybridSearch implementation.

Purpose: Expose semantic memory search as a skill following established patterns from browser/bash skills.
Output: Working memory_search skill with SKILL.md and run.ts script.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-telegram-memory-skills/06-RESEARCH.md

**Prior patterns to follow:**
@src/skills/bundled/browser/SKILL.md
@src/skills/bundled/browser/scripts/run.ts

**Existing implementation to wrap:**
@src/tools/memory.ts

**Tech available:** HybridSearch, MemoryStore, getHybridSearch() singleton accessor
**Established patterns:** SKILL_ARGS env var, JSON output format, wrapper skill over existing tool

**From RESEARCH.md - Don't hand-roll:**
- Don't create new search system - use existing HybridSearch
- Don't duplicate MemorySearchTool logic - import and wrap
- Use existing singleton pattern (getHybridSearch)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create memory_search skill SKILL.md</name>
  <files>src/skills/bundled/memory_search/SKILL.md</files>
  <action>
Create SKILL.md with YAML frontmatter:
- name: memory_search
- description: Search stored memories using hybrid BM25 + semantic matching
- user-invocable: true
- triggers: [remember, recall, memory, search memories, what do you know]

Document parameters in markdown body:
- query (required): Search query string
- type (optional): Filter by memory type (raw, fact, summary, preference, context, all). Default: fact
- subject (optional): Filter to facts about specific person (e.g., "user", name)
- limit (optional): Max results (default: 10, max: 50)

Document output format (JSON with success, output, exitCode).
Include examples showing common use cases.

Follow browser skill SKILL.md structure for consistency.
  </action>
  <verify>File exists at src/skills/bundled/memory_search/SKILL.md with valid YAML frontmatter</verify>
  <done>SKILL.md created with complete documentation matching browser skill pattern</done>
</task>

<task type="auto">
  <name>Task 2: Implement memory_search skill run.ts</name>
  <files>src/skills/bundled/memory_search/scripts/run.ts</files>
  <action>
Create run.ts script following browser skill pattern:

1. Import getHybridSearch from tools/memory.ts (use relative path ../../../../tools/memory.js)
2. Parse SKILL_ARGS from environment
3. Validate required 'query' parameter
4. Call search with options:
   - type: default to 'fact', use undefined for 'all'
   - limit: min(args.limit || 10, 50)
   - subject: args.subject if provided
   - recencyBoost: true
   - userSubjectBoost: 1.5
5. Format results similar to MemorySearchTool output
6. Output JSON { success, output, exitCode }

Handle error cases:
- Missing SKILL_ARGS: error with exitCode 1
- Invalid JSON: error with exitCode 1
- Missing query: error with exitCode 1
- Search error: error with exitCode 1

Use outputResult() pattern from browser skill for consistent error handling.
  </action>
  <verify>npx tsc --noEmit src/skills/bundled/memory_search/scripts/run.ts</verify>
  <done>run.ts compiles without errors and follows established skill script patterns</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] SKILL.md exists with valid YAML frontmatter (name, description, user-invocable, triggers)
- [ ] scripts/run.ts exists and compiles
- [ ] Script imports getHybridSearch correctly
- [ ] Script handles all error cases with proper JSON output
- [ ] No TypeScript errors
</verification>

<success_criteria>
- memory_search skill folder exists at src/skills/bundled/memory_search/
- SKILL.md documents parameters and usage
- run.ts wraps existing HybridSearch via singleton accessor
- Follows same patterns as browser skill
- No new dependencies introduced
</success_criteria>

<output>
After completion, create `.planning/phases/06-telegram-memory-skills/06-01-SUMMARY.md`
</output>
